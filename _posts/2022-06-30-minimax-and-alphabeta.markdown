---
layout: post
title: "Minimax 알고리즘과 alpha-beta 가지치기"
subtitle: "AI algorithm"
date: 2022-06-30 23:18:10 +0800
categories: [AI]
---

# Minimax 알고리즘과 alpha-beta 가지치기

## 미니맥스 알고리즘

### 알고리즘 적용상황

* 바둑이나 tic-tac-toe 와같은 상대와 번갈아 가면서 하는 게임에 있어 상대의 수를 미리 예측하고 플레이하는것이 이 알고리즘의 일반적인 응용일것이다.

* 초보들이 이런문제들을 해결할땐 모든 경우들을 다 열거하여 그중에서 가장 알맞는 선택을 할것이다. 하지만 바둑같은 가능한 상황들이 엄청 많은 게임을 함에 있어서는 이런방법은 아주 오랜 시간이 걸린다.

* 미니맥스 알고리즘은 우리가 상대방도 우리처럼 똑같이 영리하다고 가설한 전제하에서 진행하는 알고리즘이기에 게임을 진행할때 상대방이 최선의 결과가 예측되는 선택을 할것이 분명하다.

> 이런 개념에서 상대방의 최고의 수가 나에게 가장 최소의 영향을 끼치게 만들자 라며 나온 것이 바로 미니맥스 알고리즘이다.

***

### 알고리즘 진행

* 아래의 트리를 살펴보자
  
    > ![mnx](https://raw.githubusercontent.com/Guangwoen/Guangwoen.GitHub.io/main/pics/063001.png)

* 여기서 0, 2, 4는 나의 차례이고 1, 3은 상대방의 차례입니다. 나의 차례에서는 최선의 선택을 해야하고 상대방의 차례에서는 나에겐 최악의 선택을 하게 된다. 영리한 상대방은 나에게 유리한 선택을 할리가 없기 때문이다. (여기서 높은 수자가 유리하고 낮은수자가 불리하다)

1. leaf node 의 수자들은 차례로 나에게 유리한 경우들을 선택해 놓은 것들이다.

2. 3번줄은 상대방의 차례인데 상대방은 나에게 불리한 경우를 택할것이다. 즉 자식 노드 중 더 작은 수자를 선택한다.

3. 2번줄은 나의 차례인데 나에게 유리한 경우를 택하여 자식 노드 중 더 큰 수자를 선택한다.

4. 이렇게 번갈아가면서 마지막 0번줄 까지 선택하면 알고리즘은 끝이난다.

***

## 알파-베타 가지치기

### 간단한 설명

* 미니맥스 알고리즘은 몇 수 앞까지 예상하는지에 따라 성능이 달라진다. 례를 들어 바둑을 둘 경우 19*19 칸에서 진행하는데 이는 엄청나게 많은 가능성이 있을수 있기에 알고리즘의 진행중에서 막대한 시간과 공간을 차지하게 된다.

* 이를 해결하기위해 우리는 가능성이 없는 경우를 미리 제거하는것이 바로 알파-베타 가지치기다. 미리 쓸모없는 가능성들을 제거함으로써 시간과 공간의 낭비를 줄일수 있다.

### 가지치기 진행

* 아래의 트리를 살펴보자

    > ![abg](https://raw.githubusercontent.com/Guangwoen/Guangwoen.GitHub.io/main/pics/063002.png)

* 미니맥스 알고리즘의 진행대로 가면서 가지치기를 해본다. 검색방식은 DFS이다.

1. 나의 차례인 4번줄부터 차례로 검사한다.

2. 3번줄에서 왼쪽부터 검사한다. 상대방은 5와 6중에서 더 작은 5를 선택하였고 7, 4, 5에서 차례로 검사를 시작한다. 7과 4를 검사한후 5를 검사 하기전에 이런 생각을 해본다.

    > 만약 4보다 큰 수가 나온다면 상대방은 이들중에서 가장작은 4를 선택하게 된다.

    > 만약 4보다 작은 수가 나온다면 상대방은 4보다 더 작은 이 수를 선택하게 된다. 하지만 다음의 내차례, 즉 2번줄에서 선택할때 이 수는 5보다 작기에 결국 더 큰 5를 선택하게 된다. 

    * 즉 이때 어떤수가 나오던지 상대방이든 나자신이든 이 수를 선택하지 않게된다. 그래서 이때 우리는 미리 가지치기를 해버린다.

3. 이번엔 마지막 8이 들어있는 2번째 줄의 노드를 검사해보자.
   
    > 만약 이 노드의 수자가 5보다 큰 수자라면 1번째 줄에서는 무조건 더 작은 5를 선택하게 된다.

    > 만약 이 노드의 수자가 5보다 작은 수자라면 1번째 줄에서는 더 작은 이 수를 선택할수 있지만 0번째 줄에서는 결국 더 큰 수자를 선택하는 것이기에 5보다 작은 수자라면 6보다 무조건 작기에 0번째 줄에서는 결국 6을 선택하게 된다.

* 결론적으로 말하면 내가 택하지도 않고 상대방도 택하지 않기에 어떤수가 나와도 선택될수 없는 가지를 가지치기를 하는것이 알파-베타 가지치기의 개념이다.
